{
  "Id": 50333612,
  "Comment": "",
  "IsScript": true,
  "RunOnMapInit": false,
  "Script": "scope BossAku1 initializer init\r\n\r\n    globals\r\n        private constant integer BOSS_ID = 'n04O'\r\n        private constant real TICK = 1\r\n        \r\n        private constant real SEARCH_RANGE_INITIAL = 600\r\n        private constant real SEARCH_RANGE_ADDITIVE = 50\r\n        private constant real SEARCH_RANGE_MAX = 3000\r\n        \r\n        private constant integer STRING_HASH = StringHash( \"bsdl\" )\r\n    endglobals\r\n\r\n    private function condition takes nothing returns boolean\r\n        return GetUnitTypeId(udg_DamageEventTarget) == BOSS_ID\r\n    endfunction\r\n\r\n    private function cast takes nothing returns nothing\r\n        local integer id = GetHandleId( GetExpiredTimer( ) )\r\n        local unit boss = LoadUnitHandle( udg_hash, id, STRING_HASH)\r\n        local real range = LoadReal( udg_hash, id, STRING_HASH )\r\n        local unit champion = LoadUnitHandle( udg_hash, GetHandleId( boss ), STRING_HASH )\r\n\r\n        if IsUnitDeadBJ(boss) or not( udg_fightmod[0] ) then\r\n            call FlushChildHashtable( udg_hash, id )\r\n            call DestroyTimer( GetExpiredTimer() )\r\n        elseif IsUnitDeadBJ(champion) or champion == null then\r\n            set champion = randomtarget( boss, range, \"enemy\", \"hero\", \"\", \"\", \"\" )\r\n            if champion != null then\r\n                call DisplayTimedTextToForce( bj_FORCE_ALL_PLAYERS, 8, \"|cffffcc00CHAMPION: \" + udg_Player_Color[GetConvertedPlayerId(GetOwningPlayer(champion))] + GetUnitName(champion) + \"|r.\" )\r\n                call SaveUnitHandle( udg_hash, GetHandleId( boss ), STRING_HASH, champion )\r\n            elseif range < SEARCH_RANGE_MAX then\r\n                call SaveReal( udg_hash, id, STRING_HASH, range + SEARCH_RANGE_ADDITIVE )\r\n            endif\r\n        else\r\n            call IssueTargetOrder( boss, \"attack\", champion )\r\n        endif\r\n\r\n        set boss = null\r\n        set champion = null\r\n    endfunction\r\n\r\n    private function action takes nothing returns nothing\r\n        local integer id = GetHandleId( udg_DamageEventTarget )\r\n        local integer timerId\r\n        local timer t \r\n        \r\n        call DisableTrigger( GetTriggeringTrigger() )\r\n        \r\n        if LoadTimerHandle( udg_hash, id, STRING_HASH ) == null then\r\n            call SaveTimerHandle( udg_hash, id, STRING_HASH, CreateTimer() )\r\n        endif\r\n        set t = LoadTimerHandle( udg_hash, id, STRING_HASH )\r\n        set timerId = GetHandleId( t ) \r\n        call SaveUnitHandle( udg_hash, timerId, STRING_HASH, udg_DamageEventTarget )\r\n        call SaveReal( udg_hash, timerId, STRING_HASH, SEARCH_RANGE_INITIAL )\r\n        call TimerStart( t, TICK, true, function cast )\r\n        \r\n        set t = null\r\n    endfunction\r\n\r\n    //===========================================================================\r\n    private function init takes nothing returns nothing\r\n        set gg_trg_Aku1 = CreateEventTrigger( \"udg_AfterDamageEvent\", function action, function condition )\r\n        call DisableTrigger( gg_trg_Aku1 )\r\n    endfunction\r\n\r\nendscope",
  "Events": [],
  "LocalVariables": [],
  "Conditions": [],
  "Actions": []
}
{
  "Id": 50332707,
  "Comment": "",
  "IsScript": true,
  "RunOnMapInit": false,
  "Script": "scope Zuma initializer init\r\n    globals\r\n        private constant integer ZUMA_DAMAGE = 300\r\n        private constant integer ZUMA_BONUS_DAMAGE = 100\r\n        \r\n        private constant integer ID_ZUMA_ITEM = 'I0GR'\r\n        private constant integer ID_ZUMA_ABILITY = 'A12E'\r\n        \r\n        private integer array Zuma_Damage[PLAYERS_LIMIT_ARRAYS]\r\n    endglobals\r\n\r\n    private function Conditions takes nothing returns boolean\r\n        return GetSpellAbilityId() == ID_ZUMA_ABILITY\r\n    endfunction\r\n\r\n    private function Use takes unit caster, unit target, real damage returns nothing\r\n        local integer index = GetUnitUserData(caster)\r\n        local item it = GetItemOfTypeFromUnitBJ( caster, ID_ZUMA_ITEM)\r\n    \r\n        call DestroyEffect( AddSpecialEffect( \"Blink Blue Target.mdx\", GetUnitX(target), GetUnitY(target) ) )\r\n        call UnitTakeDamage(caster, target, damage, DAMAGE_TYPE_MAGIC)\r\n        \r\n        if combat(caster, false, 0) then\r\n            set Zuma_Damage[index] = Zuma_Damage[index] + ZUMA_BONUS_DAMAGE\r\n            call BlzSetItemExtendedTooltip( it, words( caster, BlzGetItemExtendedTooltip(it), \"|cffbe81f7\", \"|r\", I2S( ZUMA_DAMAGE + Zuma_Damage[index] ) ) ) // sadtwig\r\n            //call BlzSetItemIconPath( it, words( caster, BlzGetItemExtendedTooltip(it), \"|cffbe81f7\", \"|r\", I2S( ZUMA_DAMAGE + Zuma_Damage[index] ) ) )\r\n        endif\r\n        \r\n        set caster = null\r\n        set target = null\r\n        set it = null\r\n    endfunction\r\n\r\n    private function Actions takes nothing returns nothing\r\n        local unit caster\r\n        local unit target\r\n        local integer cyclA = 1\r\n        local integer cyclAEnd \r\n        local real damage\r\n        \r\n        if CastLogic() then\r\n            set caster = udg_Caster\r\n            set target = udg_Target\r\n        elseif RandomLogic() then\r\n            set caster = udg_Caster\r\n            set target = randomtarget( caster, 900, \"all\", \"\", \"\", \"\", \"\" )\r\n            call textst( udg_string[0] + GetObjectName(ID_ZUMA_ABILITY), caster, 64, 90, 10, 1.5 )\r\n            if target == null then\r\n                set caster = null\r\n                return\r\n            endif\r\n        else\r\n            set caster = GetSpellAbilityUnit()\r\n            set target = GetSpellTargetUnit()\r\n        endif\r\n        \r\n        set damage = ZUMA_DAMAGE + Zuma_Damage[GetUnitUserData(caster)]\r\n        \r\n        set cyclAEnd = eyest( caster )\r\n        loop\r\n            exitwhen cyclA > cyclAEnd\r\n            call Use(caster, target, damage)\r\n            set cyclA = cyclA + 1\r\n        endloop\r\n        \r\n        set caster = null\r\n        set target = null\r\n    endfunction\r\n    \r\n    private function FightEnd_Conditions takes nothing returns boolean\r\n        return Zuma_Damage[GetUnitUserData(udg_FightEnd_Unit)] > 0\r\n    endfunction\r\n    \r\n    private function FightEnd takes nothing returns nothing\r\n        local unit hero = udg_FightEnd_Unit\r\n        local item it = GetItemOfTypeFromUnitBJ( hero, ID_ZUMA_ITEM)\r\n        local integer index = GetUnitUserData(hero)\r\n\r\n        set Zuma_Damage[index] = 0\r\n        if it != null then\r\n            call BlzSetItemExtendedTooltip( it, words( hero, BlzGetItemDescription(it), \"|cffbe81f7\", \"|r\", I2S( ZUMA_DAMAGE + Zuma_Damage[index] ) ) ) // sadtwig\r\n            //call BlzSetItemIconPath( it, words( hero, BlzGetItemDescription(it), \"|cffbe81f7\", \"|r\", I2S( ZUMA_DAMAGE + Zuma_Damage[index] ) ) )\r\n        endif\r\n        \r\n        set it = null\r\n        set hero = null\r\n    endfunction\r\n\r\n    private function init takes nothing returns nothing\r\n        set gg_trg_Zuma = CreateTrigger(  )\r\n        call TriggerRegisterAnyUnitEventBJ( gg_trg_Zuma, EVENT_PLAYER_UNIT_SPELL_EFFECT )\r\n        call TriggerAddCondition( gg_trg_Zuma, Condition( function Conditions ) )\r\n        call TriggerAddAction( gg_trg_Zuma, function Actions )\r\n        \r\n        call CreateEventTrigger( \"udg_FightEnd_Real\", function FightEnd, function FightEnd_Conditions )\r\n    endfunction\r\nendscope",
  "Events": [],
  "LocalVariables": [],
  "Conditions": [],
  "Actions": []
}
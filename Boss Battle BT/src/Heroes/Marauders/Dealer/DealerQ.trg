{
  "Id": 50333159,
  "Comment": "",
  "IsScript": true,
  "RunOnMapInit": false,
  "Script": "function Trig_DealerQ_Conditions takes nothing returns boolean\r\n    return GetSpellAbilityId() == 'A183'\r\nendfunction\r\n\r\nfunction SpawnBanana takes unit caster, real x, real y returns nothing\r\n    set bj_lastCreatedUnit = CreateUnit( GetOwningPlayer( caster ), 'o01B', x, y, GetRandomReal( 0, 360 ) )\r\n    call DestroyEffect( AddSpecialEffectTarget( \"Abilities\\\\Spells\\\\Orc\\\\FeralSpirit\\\\feralspirittarget.mdl\", bj_lastCreatedUnit, \"origin\" ) )\r\n    call UnitApplyTimedLife( bj_lastCreatedUnit , 'BTLF', BERRY_DEALER_R_BANANA_LIFE_TIME )\r\n    call DestroyEffect( AddSpecialEffect( \"Objects\\\\Spawnmodels\\\\Demon\\\\DemonLargeDeathExplode\\\\DemonLargeDeathExplode.mdl\", GetUnitX(  bj_lastCreatedUnit ), GetUnitY(  bj_lastCreatedUnit ) ) )\r\n\r\n    set caster = null\r\nendfunction\r\n\r\nfunction Trig_DealerQ_Actions takes nothing returns nothing\r\n    local unit caster\r\n    local unit target\r\n    local integer lvl\r\n    local real dmg\r\n    local integer bananas\r\n    local real money\r\n    local integer i\r\n    local integer iEnd\r\n    \r\n    if CastLogic() then\r\n        set caster = udg_Caster\r\n        set target = udg_Target\r\n        set lvl = udg_Level\r\n    elseif RandomLogic() then\r\n        set caster = udg_Caster\r\n        set target = randomtarget( caster, 900, \"all\", \"\", \"\", \"\", \"\" )\r\n        set lvl = udg_Level\r\n        call textst( udg_string[0] + GetObjectName('A183'), caster, 64, 90, 10, 1.5 )\r\n        if target == null then\r\n            set caster = null\r\n            return\r\n        endif\r\n    else\r\n        set caster = GetSpellAbilityUnit()\r\n        set target = GetSpellTargetUnit()\r\n        set lvl = GetUnitAbilityLevel(GetSpellAbilityUnit(), GetSpellAbilityId())\r\n    endif\r\n    set dmg = 100 + ( 50 * lvl )\r\n    set money = 30 + ( 10 * lvl )\r\n    \r\n    if lvl == 1 or lvl == 2 then\r\n        set bananas = 1\r\n    elseif lvl == 3 or lvl == 4 then\r\n        set bananas = 2\r\n    elseif lvl == 5 then\r\n        set bananas = 3\r\n    endif\r\n    \r\n    call DestroyEffect( AddSpecialEffectTarget( \"Objects\\\\Spawnmodels\\\\Demon\\\\DemonLargeDeathExplode\\\\DemonLargeDeathExplode.mdl\", target, \"origin\" ) )\r\n\r\n    call dummyspawn( caster, 1, 0, 0, 0 )\r\n    call UnitDamageTarget(bj_lastCreatedUnit, target, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)\r\n    if GetUnitState( target, UNIT_STATE_LIFE) <= 0.405 then\r\n        if combat( caster, false, 0 ) and not( udg_fightmod[3] ) then\r\n            call moneyst( caster, R2I(money) )\r\n        endif\r\n    else\r\n        set i = 1\r\n        set iEnd = bananas\r\n        loop\r\n            exitwhen i > iEnd\r\n            call SpawnBanana( caster, Math_GetRandomX(GetUnitX( target ), 200), Math_GetRandomY(GetUnitY( target ), 200) )\r\n            set i = i + 1\r\n        endloop\r\n    endif\r\n\r\n    set caster = null\r\n    set target = null\r\nendfunction\r\n\r\n//===========================================================================\r\nfunction InitTrig_DealerQ takes nothing returns nothing\r\n    set gg_trg_DealerQ = CreateTrigger(  )\r\n    call TriggerRegisterAnyUnitEventBJ( gg_trg_DealerQ, EVENT_PLAYER_UNIT_SPELL_EFFECT )\r\n    call TriggerAddCondition( gg_trg_DealerQ, Condition( function Trig_DealerQ_Conditions ) )\r\n    call TriggerAddAction( gg_trg_DealerQ, function Trig_DealerQ_Actions )\r\nendfunction\r\n\r\n",
  "Events": [],
  "LocalVariables": [],
  "Conditions": [],
  "Actions": []
}
{
  "Id": 503330691,
  "Comment": "luck with riches?\r\ncall luckyst( GetManipulatingUnit(), count[2] )\r\ncall textst( \"|cFFFE8A0E +\"+I2S(count[2])+\" luck\", GetManipulatingUnit(), 64, 120, 10, 3 )",
  "IsScript": true,
  "RunOnMapInit": false,
  "Script": "scope RunesmithE initializer init\r\n\r\n    globals\r\n            private constant integer ID_ABILITY = 'A1E3'\r\n            private constant integer ID_RUNE_LG = 'I03O'\r\n            private constant integer ID_RUNE_RC = 'I03K'\r\n            private constant integer ID_RUNE_SH = 'I03N'\r\n            private constant integer ID_RUNE_EM = 'I03P'\r\n            private constant integer ID_RUNE_ST = 'I03M'\r\n            private constant integer ID_RUNE_IL = 'I03L'\r\n            private constant string ID_HASH_GAINED_GOLD = \"runesmith_gained_gold\"\r\n            private constant string ID_HASH_GAINED_HPR = \"runesmith_gained_hpr\"\r\n            private constant string ID_HASH_GAINED_SP = \"runesmith_gained_sp\"\r\n            private constant string ID_HASH_GAINED_HP = \"runesmith_gained_hp\"\r\n            private constant string ID_HASH_GAINED_AP = \"runesmith_gained_ap\"\r\n            private constant string ID_HASH_GAINED_STATS = \"runesmith_gained_stats\"\r\n            private constant string ID_HASH_TMP_AR = \"runesmith_tmp_ar\"\r\n            private constant real LG_REGEN_BOOST = 0.5\r\n            private constant real SH_ARMOR_BOOST = 1.0\r\n            private constant real ST_SP_BOOST = 1.0\r\n            private constant integer EM_CDR = 5\r\n    endglobals\r\n    \r\n    private function Trig_RunesmithE_Conditions takes nothing returns boolean\r\n        return not(udg_fightmod[3]) and GetUnitAbilityLevel(GetManipulatingUnit(), ID_ABILITY) > 0 and ( GetItemTypeId(GetManipulatedItem()) == ID_RUNE_LG or GetItemTypeId(GetManipulatedItem()) == ID_RUNE_RC or GetItemTypeId(GetManipulatedItem()) == ID_RUNE_SH or GetItemTypeId(GetManipulatedItem()) == ID_RUNE_EM or GetItemTypeId(GetManipulatedItem()) == ID_RUNE_ST or GetItemTypeId(GetManipulatedItem()) == ID_RUNE_IL )\r\n    endfunction\r\n\r\n    private function giveRC takes nothing returns nothing\r\n        local real gold_gained = LoadReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_GOLD ))\r\n        set gold_gained = gold_gained + 50\r\n        call SaveReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_GOLD ), gold_gained )\r\n        call moneyst(GetEnumUnit() , 50)\r\n    endfunction\r\n    \r\n    private function addRegen takes nothing returns nothing\r\n        local real hpr_gained = LoadReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_HPR ))\r\n        set hpr_gained = hpr_gained + LG_REGEN_BOOST\r\n        call SaveReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_HPR ), hpr_gained )\r\n        call BlzSetUnitRealFieldBJ( GetEnumUnit(), UNIT_RF_HIT_POINTS_REGENERATION_RATE, (BlzGetUnitRealField(GetEnumUnit(), UNIT_RF_HIT_POINTS_REGENERATION_RATE) + LG_REGEN_BOOST) )\r\n        set bj_lastCreatedUnit=CreateUnit(GetOwningPlayer(GetEnumUnit()), 'u000', GetUnitX(GetEnumUnit()), GetUnitY(GetEnumUnit())+100, 270)\r\n        call textst(\"|c00FF9696 +\"+R2SW(LG_REGEN_BOOST,1,1)+\" regen\" , bj_lastCreatedUnit , 64 , 90 , 10 , 1)\r\n        call RemoveUnit(bj_lastCreatedUnit)\r\n    endfunction\r\n    \r\n    private function giveSH takes nothing returns nothing\r\n        local real hp_gained = LoadReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_HP ))\r\n        set hp_gained = hp_gained + 25\r\n        call SaveReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_HP ), hp_gained )\r\n        call BlzSetUnitMaxHP(GetEnumUnit(), BlzGetUnitMaxHP(GetEnumUnit()) + 25)\r\n        call textst(\"|c0020FF20 +25 health\" , GetEnumUnit() , 64 , 90 , 10 , 1)\r\n    endfunction\r\n\r\n    private function addTmpArmor takes nothing returns nothing\r\n        local real ar_gained = LoadReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_TMP_AR ))\r\n        set ar_gained = ar_gained + SH_ARMOR_BOOST\r\n        call SaveReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_TMP_AR ), ar_gained )\r\n        call BlzSetUnitArmor(GetEnumUnit(), BlzGetUnitArmor(GetEnumUnit()) + SH_ARMOR_BOOST)\r\n    endfunction\r\n    \r\n    private function reduceCds takes nothing returns nothing\r\n        call UnitReduceCooldown(GetEnumUnit(), EM_CDR)\r\n        set bj_lastCreatedUnit=CreateUnit(GetOwningPlayer(GetEnumUnit()), 'u000', GetUnitX(GetEnumUnit()), GetUnitY(GetEnumUnit())+100, 270)\r\n        call textst(\"|c00540081 -\" + I2S(EM_CDR) + \" cd\" , bj_lastCreatedUnit , 64 , 90 , 10 , 1)\r\n        call RemoveUnit(bj_lastCreatedUnit)\r\n        \r\n    endfunction\r\n    \r\n    private function addSP takes nothing returns nothing\r\n        local real sp_gained = LoadReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_SP ))\r\n        set sp_gained = sp_gained + ST_SP_BOOST\r\n        call SaveReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_SP ), sp_gained )\r\n        call spdst( GetEnumUnit(), ST_SP_BOOST)\r\n        set bj_lastCreatedUnit=CreateUnit(GetOwningPlayer(GetEnumUnit()), 'u000', GetUnitX(GetEnumUnit()), GetUnitY(GetEnumUnit())+100, 270)\r\n        call textst(\"|cFF7EBFF1 +\"+R2SW(ST_SP_BOOST,1,1)+\" spell power\" , bj_lastCreatedUnit , 64 , 90 , 10 , 1)\r\n        call RemoveUnit(bj_lastCreatedUnit)\r\n    endfunction\r\n    \r\n    private function giveST takes nothing returns nothing\r\n        local real ap_gained = LoadReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_AP ))\r\n        set ap_gained = ap_gained + 1\r\n        call SaveReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_HP ), ap_gained )\r\n        call BlzSetUnitBaseDamage(GetEnumUnit(), BlzGetUnitBaseDamage(GetEnumUnit(), 0) + 1, 0)\r\n        call textst(\"|c00FF2020 +1 attack\" , GetEnumUnit() , 64 , 90 , 10 , 1)\r\n    endfunction\r\n    \r\n    private function giveIL takes nothing returns nothing\r\n        local real stats_gained = LoadReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_STATS ))\r\n        set stats_gained = stats_gained + 1\r\n        call SaveReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_STATS ), stats_gained )\r\n        call RandomStat(GetEnumUnit() , 1 , 0 , true)\r\n    endfunction\r\n    \r\n    private function RandomStat2 takes unit caster,integer i,integer data,boolean l returns nothing\r\n        local integer rand\r\n        local integer r= data\r\n        set rand=GetRandomInt(1, 3)\r\n        set bj_lastCreatedUnit=CreateUnit(GetOwningPlayer(GetEnumUnit()), 'u000', GetUnitX(GetEnumUnit()), GetUnitY(GetEnumUnit())+100, 270)\r\n        if rand == 1 then\r\n            call statst(caster , i , 0 , 0 , r , l)\r\n            call textst(\"|c00FF2020 +\" + I2S(i) + \" strength\" , bj_lastCreatedUnit , 64 , 90 , 10 , 1)\r\n        elseif rand == 2 then\r\n            if r != 0 then\r\n                set r=r + 4\r\n            endif\r\n            call statst(caster , 0 , i , 0 , r , l)\r\n            call textst(\"|c0020FF20 +\" + I2S(i) + \" agility\" , bj_lastCreatedUnit , 64 , 90 , 10 , 1)\r\n        elseif rand == 3 then\r\n            if r != 0 then\r\n                set r=r + 8\r\n            endif\r\n            call statst(caster , 0 , 0 , i , r , l)\r\n            call textst(\"|c002020FF +\" + I2S(i) + \" intelligence\" , bj_lastCreatedUnit , 64 , 90 , 10 , 1)\r\n        endif\r\n        call RemoveUnit(bj_lastCreatedUnit)\r\n        set caster=null\r\n    endfunction\r\n    \r\n    private function giveIL2 takes nothing returns nothing\r\n        local real stats_gained = LoadReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_STATS ))\r\n        set stats_gained = stats_gained + 1\r\n        call SaveReal( udg_hash, GetHandleId( GetEnumUnit() ), StringHash( ID_HASH_GAINED_STATS ), stats_gained )\r\n        call RandomStat2(GetEnumUnit() , 1 , 0 , true)\r\n    endfunction\r\n    \r\n    function Trig_RunesmithE_Actions takes nothing returns nothing\r\n        local unit source = GetManipulatingUnit()\r\n        local group others = DeathSystem_GetAliveHeroGroupCopy()\r\n        local group allHeroes = DeathSystem_GetAliveHeroGroupCopy()\r\n        local integer lvl = GetUnitAbilityLevel(source, ID_ABILITY)\r\n        \r\n        call GroupRemoveUnit(others, source)\r\n        \r\n        if GetItemTypeId(GetManipulatedItem()) == ID_RUNE_RC then\r\n            call ForGroupBJ(others, function giveRC)\r\n        elseif lvl > 0 and GetItemTypeId(GetManipulatedItem()) == ID_RUNE_LG then\r\n            call ForGroupBJ(allHeroes, function addRegen)\r\n        elseif GetItemTypeId(GetManipulatedItem()) == ID_RUNE_SH then\r\n            call ForGroupBJ(others, function giveSH)\r\n            if lvl > 1 then\r\n                call ForGroupBJ(allHeroes, function addTmpArmor)\r\n            endif\r\n        elseif lvl > 2 and GetItemTypeId(GetManipulatedItem()) == ID_RUNE_EM then\r\n            call ForGroupBJ(allHeroes, function reduceCds)\r\n        elseif GetItemTypeId(GetManipulatedItem()) == ID_RUNE_ST then\r\n            call ForGroupBJ(others, function giveST)\r\n            if lvl > 3 then\r\n                call ForGroupBJ(allHeroes, function addSP)\r\n            endif\r\n        elseif GetItemTypeId(GetManipulatedItem()) == ID_RUNE_IL then\r\n            call ForGroupBJ(others, function giveIL)\r\n            if lvl > 4 then\r\n                call ForGroupBJ(allHeroes, function giveIL2)\r\n            endif\r\n        endif\r\n        \r\n        call DestroyGroup(others)\r\n        call DestroyGroup(allHeroes)\r\n        set allHeroes = null\r\n        set others = null\r\n        set source = null\r\n    endfunction\r\n\r\n    //===========================================================================\r\n    private function init takes nothing returns nothing\r\n        set gg_trg_RunesmithE = CreateTrigger( )\r\n        call TriggerRegisterAnyUnitEventBJ( gg_trg_RunesmithE, EVENT_PLAYER_UNIT_PICKUP_ITEM )\r\n        call TriggerAddCondition( gg_trg_RunesmithE, Condition( function Trig_RunesmithE_Conditions ) )\r\n        call TriggerAddAction( gg_trg_RunesmithE, function Trig_RunesmithE_Actions )\r\n    endfunction\r\n    \r\nendscope",
  "Events": [],
  "LocalVariables": [],
  "Conditions": [],
  "Actions": []
}
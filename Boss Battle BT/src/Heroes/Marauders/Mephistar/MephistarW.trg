{
  "Id": 50333172,
  "Comment": "",
  "IsScript": true,
  "RunOnMapInit": false,
  "Script": "function Trig_MephistarW_Conditions takes nothing returns boolean\r\n    return GetSpellAbilityId() == 'A149'\r\nendfunction\r\n\r\nfunction Trig_MephistarW_Actions takes nothing returns nothing\r\n    local integer id \r\n    local unit caster\r\n    local unit target\r\n    local integer rand\r\n    local integer lvl\r\n    local integer i\r\n    local real hp\r\n    local real mp\r\n    local real r\r\n    \r\n    if CastLogic() then\r\n        set caster = udg_Caster\r\n        set target = udg_Target\r\n        set lvl = udg_Level\r\n    elseif RandomLogic() then\r\n        set caster = udg_Caster\r\n        set target = randomtarget( caster, 900, \"ally\", \"hero\", \"notcaster\", \"\", \"\" )\r\n        set lvl = udg_Level\r\n        call textst( udg_string[0] + GetObjectName('A149'), caster, 64, 90, 10, 1.5 )\r\n        if target == null then\r\n            set caster = null\r\n            return\r\n        endif\r\n    else\r\n        set caster = GetSpellAbilityUnit()\r\n        set target = GetSpellTargetUnit()\r\n        set lvl = GetUnitAbilityLevel(GetSpellAbilityUnit(), GetSpellAbilityId())\r\n    endif\r\n    \r\n    set r = 0.8+(0.2*lvl)\r\n    \r\n    if combat( caster, false, 0 ) and not( udg_fightmod[3] ) then\r\n        set i = GetPlayerId( GetOwningPlayer( target ) ) + 1\r\n        set rand = GetRandomInt( 1, 6 )\r\n        if rand == 1 then\r\n            call statst( target, 1, 0, 0, 0, true )\r\n            call textst( \"|c00FF2020 +1 strength\", target, 64, 90, 10, 1 )\r\n        elseif rand == 2 then\r\n            call statst( target, 0, 1, 0, 0, true )\r\n            call textst( \"|c0020FF20 +1 agility\", target, 64, 90, 10, 1 )\r\n        elseif rand == 3 then\r\n            call statst( target, 0, 0, 1, 0, true )\r\n            call textst( \"|c002020FF +1 intelligence\", target, 64, 90, 10, 1 )\r\n        elseif rand == 4 then\r\n            call luckyst( target, 1 )\r\n            call textst( \"|cFFFE8A0E +1 luck\", target, 64, 90, 10, 1 )\r\n        elseif rand == 5 then\r\n            call spdst( target, 1 )\r\n            call textst( \"|cFF7EBFF1 +1\"+udg_perc+\" spell power\", target, 64, 90, 10, 1 )\r\n        elseif rand == 6 then\r\n            call moneyst( target, 75 )\r\n            call textst( \"|cFFFFFC01 +75 gold\", target, 64, 90, 10, 1 )\r\n        endif\r\n    endif\r\n\r\n    set hp = RMinBJ(GetUnitState( target, UNIT_STATE_MAX_LIFE) * 0.15,GetUnitState( target, UNIT_STATE_LIFE) )\r\n    set mp = RMinBJ(GetUnitState( target, UNIT_STATE_MAX_MANA) * 0.15,GetUnitState( target, UNIT_STATE_MANA) )\r\n    \r\n    call DestroyEffect( AddSpecialEffect( \"Abilities\\\\Spells\\\\Items\\\\TomeOfRetraining\\\\TomeOfRetrainingCaster.mdl\", GetUnitX(caster), GetUnitY(caster) ) )\r\n    call DestroyEffect( AddSpecialEffect( \"Abilities\\\\Spells\\\\Items\\\\TomeOfRetraining\\\\TomeOfRetrainingCaster.mdl\", GetUnitX(target), GetUnitY(target) ) )\r\n    \r\n    call SetUnitState( target, UNIT_STATE_LIFE, RMaxBJ(10, GetUnitState( target, UNIT_STATE_LIFE) - RMinBJ(GetUnitState( caster, UNIT_STATE_MAX_LIFE)-GetUnitState( caster, UNIT_STATE_LIFE), hp) ) )\r\n    call SetUnitState( target, UNIT_STATE_MANA, RMaxBJ(10, GetUnitState( target, UNIT_STATE_MANA) - RMinBJ(GetUnitState( caster, UNIT_STATE_MAX_MANA)-GetUnitState( caster, UNIT_STATE_MANA), mp) ) )\r\n    \r\n    call healst( caster, null, hp*r )\r\n    call manast( caster, null, mp*r )\r\n    \r\n    set caster = null\r\n    set target = null\r\nendfunction\r\n\r\n//===========================================================================\r\nfunction InitTrig_MephistarW takes nothing returns nothing\r\n    set gg_trg_MephistarW = CreateTrigger(  )\r\n    call TriggerRegisterAnyUnitEventBJ( gg_trg_MephistarW, EVENT_PLAYER_UNIT_SPELL_EFFECT )\r\n    call TriggerAddCondition( gg_trg_MephistarW, Condition( function Trig_MephistarW_Conditions ) )\r\n    call TriggerAddAction( gg_trg_MephistarW, function Trig_MephistarW_Actions )\r\nendfunction\r\n\r\n",
  "Events": [],
  "LocalVariables": [],
  "Conditions": [],
  "Actions": []
}
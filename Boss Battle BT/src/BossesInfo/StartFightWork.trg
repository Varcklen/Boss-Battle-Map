{
  "Id": 50333394,
  "Comment": "",
  "IsScript": true,
  "RunOnMapInit": false,
  "Script": "scope StartFightWork\r\n\tglobals\r\n\t\tunit MainBoss = null\r\n\tendglobals\r\n\t\r\n\tfunction StartFight takes nothing returns nothing\r\n\t    local integer cyclA = 1\r\n\t    local integer cyclAEnd\r\n\t    local integer cyclB\r\n\t    local integer id\r\n\t    local integer i\r\n\t    local unit boss = null\r\n\t    local unit boss2 = null\r\n\t    local real x\r\n\t    local real y\r\n\t    local integer v\r\n\t    local integer n\r\n\t    local location array reg\r\n\t    local real bx\r\n\t    local real by\r\n\t\r\n\t\tif BossArenaChoise[udg_Boss_LvL][udg_Boss_Random] == 2 and not(udg_logic[78]) then\r\n\t        set udg_Boss_Rect = gg_rct_ArenaBossSmall\r\n\t        set udg_Boss_BigRect = gg_rct_Vision4\r\n\t\t\tset reg[1] = udg_point[30]\r\n\t\t\tset reg[2] = udg_point[31]\r\n\t\t\tset reg[3] = udg_point[32]\r\n\t\t\tset reg[4] = udg_point[33]\r\n\t\t\tset bx = GetRectCenterX(gg_rct_BossSpawnSmall)\r\n\t\t\tset by = GetRectCenterY(gg_rct_BossSpawnSmall)\r\n\t\telse\r\n\t        set udg_Boss_Rect = gg_rct_ArenaBoss\r\n\t        set udg_Boss_BigRect = gg_rct_Vision2\r\n\t\t\tset reg[1] = udg_point[5]\r\n\t\t\tset reg[2] = udg_point[6]\r\n\t\t\tset reg[3] = udg_point[7]\r\n\t\t\tset reg[4] = udg_point[8]\r\n\t\t\tset bx = GetRectCenterX(gg_rct_BossSpawn)\r\n\t\t\tset by = GetRectCenterY(gg_rct_BossSpawn)\r\n\t\tendif\r\n\t\r\n\t    set udg_fightmod[1] = true\r\n\t    call FightStart()\r\n\t\r\n\t    loop\r\n\t        exitwhen cyclA > 4\r\n\t        if GetPlayerSlotState( Player( cyclA - 1 ) ) == PLAYER_SLOT_STATE_PLAYING then\r\n\t            call SetUnitPositionLoc( udg_hero[cyclA], reg[cyclA] )\r\n\t            call SetUnitFacing( udg_hero[cyclA], 90 )\r\n\t            call PanCameraToTimedLocForPlayer( Player( cyclA - 1 ), reg[cyclA], 0 )\r\n\t            call DestroyEffect( AddSpecialEffect( \"Void Teleport Caster.mdx\", GetUnitX( udg_hero[cyclA] ), GetUnitY( udg_hero[cyclA] ) ) )\r\n\t            \r\n\t            set cyclB = 1\r\n\t            loop\r\n\t                exitwhen cyclB > 6\r\n\t                if cyclB != udg_Boss_Random then\r\n\t                    call UnitRemoveAbility( udg_unit[cyclA + 17], Boss_Info[udg_Boss_LvL][cyclB] )\r\n\t                endif\r\n\t                set cyclB = cyclB + 1\r\n\t            endloop\r\n\t        endif\r\n\t        set cyclA = cyclA + 1\r\n\t    endloop\r\n\t    if udg_Boss_LvL != 10 then\r\n\t        set cyclB = 1\r\n\t        loop\r\n\t            exitwhen cyclB > 6\r\n\t            if cyclB == udg_Boss_Random  then\r\n\t                set v = Boss_Info[udg_Boss_LvL][cyclB]\r\n\t                call IconFrame( \"boss\", BlzGetAbilityIcon(v), BlzGetAbilityTooltip(v, 0), BlzGetAbilityExtendedTooltip(v, 0) )\r\n\t            endif\r\n\t            set cyclB = cyclB + 1\r\n\t        endloop\r\n\t    endif\r\n\t\r\n\t\tcall MainBattleHeroDeath_Enable()\r\n\t    //call EnableTrigger( gg_trg_HeroDeath )\r\n\t    call EnableTrigger( gg_trg_BossDamage )\r\n\t    call EnableTrigger( gg_trg_MinionsTeleportation )\r\n\t    if udg_Boss_LvL == 1 then\r\n\t        set udg_UntilFirstFight = false\r\n\t        set udg_LogicModes = false\r\n\t        call BlzFrameSetVisible( rpkmod,false)\r\n\t        call BlzFrameSetVisible( reselectionButton,false)\r\n\t        set cyclA = 1\r\n\t        loop\r\n\t            exitwhen cyclA > 4\r\n\t            if cyclA == 1 then\r\n\t                call UnitRemoveAbility( udg_unit[cyclA + 31], 'A06V' )\r\n\t                call UnitRemoveAbility( udg_unit[cyclA + 31], 'A0J8' )\r\n\t                call UnitRemoveAbility( udg_unit[cyclA + 31], 'A0JI' )\r\n\t                call UnitRemoveAbility( udg_unit[cyclA + 31], 'A0JJ' )\r\n\t            else\r\n\t                call RemoveUnit( udg_unit[cyclA + 31] )\r\n\t            endif\r\n\t            set udg_minion_repick[cyclA] = 0\r\n\t            set cyclA = cyclA + 1\r\n\t        endloop\r\n\t        if udg_logic[2] then\r\n\t            set udg_Multiboard_Time[1] = 0\r\n\t            set udg_Multiboard_Time[2] = 0\r\n\t            set udg_Multiboard_Time[3] = 0\r\n\t        endif\r\n\t    endif\r\n\t\r\n\t    if udg_logic[78] and udg_Boss_LvL != 1 then\r\n\t        set boss = CreateUnit( Player(10), DB_Boss_id[udg_Boss_LvL][udg_Boss_Random], GetRectCenterX(gg_rct_BossSpawn) - 600, GetRectCenterY(gg_rct_BossSpawn), 270 )\r\n\r\n\t        set cyclA = 1\r\n\t        loop\r\n\t            exitwhen cyclA > 1\r\n\t            set n = GetRandomInt( 1, 5 ) //ИСПРАВИТЬ НА 5 КОГДА ПРОБЛЕМА С КРАШЕМ БУДЕТ РЕШЕНА\r\n\t            if DB_Boss_id[udg_Boss_LvL][n] != null and DB_Boss_id[udg_Boss_LvL][n] != GetUnitTypeId( boss ) then\r\n\t                set boss2 = CreateUnit( Player(10), DB_Boss_id[udg_Boss_LvL][n], GetRectCenterX(gg_rct_BossSpawn) + 600, GetRectCenterY(gg_rct_BossSpawn), 270 )\r\n\t                call IconFrame( \"second boss\", BlzGetAbilityIcon(Boss_Info[udg_Boss_LvL][n]), BlzGetAbilityTooltip(Boss_Info[udg_Boss_LvL][n], 0), BlzGetAbilityExtendedTooltip(Boss_Info[udg_Boss_LvL][n], 0) )\r\n\t            else\r\n\t                set cyclA = cyclA - 1\r\n\t            endif\r\n\t            set cyclA = cyclA + 1\r\n\t        endloop\r\n\t    else\r\n\t        set boss = CreateUnit( Player(10), DB_Boss_id[udg_Boss_LvL][udg_Boss_Random], bx, by, 270 )\r\n\t    endif\r\n\t    set MainBoss = boss\r\n\t    \r\n\t    if boss != null then\r\n\t        set bossbar = boss\r\n\t    endif\r\n\t    if boss2 != null then\r\n\t        set bossbar1 = boss2\r\n\t    endif\r\n\t\r\n\t    call AUI_TimerGo()\r\n\t    \r\n\t\tset cyclA = 1\r\n\t    loop\r\n\t        exitwhen cyclA > 4\r\n\t        set reg[cyclA] = null\r\n\t        set cyclA = cyclA + 1\r\n\t    endloop\r\n\t\r\n\t    set boss = null\r\n\t    set boss2 = null\r\n\tendfunction\r\n\t\r\n\t//===========================================================================\r\n\tfunction InitTrig_StartFightWork takes nothing returns nothing\r\n\t    set gg_trg_StartFightWork = CreateTrigger(  )\r\n\t    call TriggerAddAction( gg_trg_StartFightWork, function StartFight )\r\n\tendfunction\r\n\t\r\nendscope",
  "Events": [],
  "LocalVariables": [],
  "Conditions": [],
  "Actions": []
}
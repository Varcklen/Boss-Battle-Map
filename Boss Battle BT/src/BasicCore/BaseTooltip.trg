{
  "Id": 50332127,
  "Comment": "",
  "IsScript": true,
  "RunOnMapInit": false,
  "Script": "scope BaseTooltip initializer init\r\n\r\n    globals \r\n         framehandle fon\r\n         framehandle readyParent\r\n         framehandle butbk\r\n         framehandle sklbk\r\n         framehandle scrbk\r\n         framehandle pvpbk\r\n         framehandle refbk\r\n         framehandle but\r\n         framehandle skl\r\n         framehandle scr\r\n         framehandle pvp\r\n         framehandle rpkmod\r\n         //framehandle juleIcon\r\n         framehandle reselectionButton\r\n         framehandle array iconframe\r\n         framehandle array faceframe\r\n         framehandle array uniqframe\r\n         framehandle array specframe\r\n         \r\n         real Event_PvPButtonClicked_Real\r\n         player Event_PvPButtonClicked_Player\r\n    endglobals\r\n\r\n    //PvP\r\n    function PvPButton takes nothing returns nothing\r\n        if GetLocalPlayer() == GetTriggerPlayer() then\r\n            call BlzFrameSetVisible( pvpbk,false)\r\n            call BlzFrameSetVisible( pvpbk,true)\r\n        endif\r\n        \r\n        set Event_PvPButtonClicked_Player = GetTriggerPlayer() \r\n        set Event_PvPButtonClicked_Real = 0.00\r\n        set Event_PvPButtonClicked_Real = 1.00\r\n        set Event_PvPButtonClicked_Real = 0.00\r\n    endfunction\r\n\r\n    //Info\r\n    function click2 takes nothing returns nothing\r\n        local player p = GetTriggerPlayer()\r\n        local integer i = GetPlayerId( p ) + 1\r\n        local unit u = udg_hero[i]\r\n        local integer id = GetHandleId( u )\r\n        //Runesmith locals\r\n        local real gold_gained = LoadReal( udg_hash, GetHandleId( u ), StringHash( \"runesmith_gained_gold\" ))\r\n        local real hpr_gained = LoadReal( udg_hash, GetHandleId( u ), StringHash( \"runesmith_gained_hpr\" ))\r\n        local real hp_gained = LoadReal( udg_hash, GetHandleId( u ), StringHash( \"runesmith_gained_hp\" ))\r\n        local real sp_gained = LoadReal( udg_hash, GetHandleId( u ), StringHash( \"runesmith_gained_sp\" ))\r\n        local real stats_gained = LoadReal( udg_hash, GetHandleId( u ), StringHash( \"runesmith_gained_stats\" ))\r\n        local real ap_gained = LoadReal( udg_hash, GetHandleId( u ), StringHash( \"runesmith_gained_ap\" ))\r\n        local real gold_granted = 0\r\n        local real hpr_granted = 0\r\n        local real hp_granted = 0\r\n        local real ap_granted = 0\r\n        local real sp_granted = 0\r\n        local real stats_granted = 0\r\n        local integer cyclA = 0\r\n        \r\n        //fetch granted stats if Runesmith\r\n        if GetUnitTypeId(u) == 'O01Z' then\r\n            set cyclA = 1\r\n            loop\r\n                exitwhen cyclA > 4\r\n                if not ( udg_hero[cyclA] == u ) then\r\n                   set gold_granted = gold_granted + LoadReal( udg_hash, GetHandleId( udg_hero[cyclA] ), StringHash( \"runesmith_gained_gold\" ))\r\n                   set hpr_granted = hpr_granted + LoadReal( udg_hash, GetHandleId( udg_hero[cyclA] ), StringHash( \"runesmith_gained_hpr\" ))\r\n                   set hp_granted = hp_granted + LoadReal( udg_hash, GetHandleId( udg_hero[cyclA] ), StringHash( \"runesmith_gained_hp\" ))\r\n                   set ap_granted = ap_granted + LoadReal( udg_hash, GetHandleId( udg_hero[cyclA] ), StringHash( \"runesmith_gained_ap\" ))\r\n                   set sp_granted = sp_granted + LoadReal( udg_hash, GetHandleId( udg_hero[cyclA] ), StringHash( \"runesmith_gained_sp\" ))\r\n                   set stats_granted = stats_granted + LoadReal( udg_hash, GetHandleId( udg_hero[cyclA] ), StringHash( \"runesmith_gained_stats\" ))\r\n                endif\r\n                set cyclA = cyclA + 1\r\n            endloop\r\n        endif\r\n        \r\n        if GetLocalPlayer() == p then\r\n            call BlzFrameSetVisible( scrbk,false)\r\n            call BlzFrameSetVisible( scrbk,true)\r\n        endif\r\n        \r\n        call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Level|r: \" + I2S( udg_LvL[i] ) )\r\n        call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Experience|r: \" + I2S( udg_Exp[i] ) )\r\n        call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Kills|r: \" + I2S( LoadInteger( udg_hash, id, StringHash( \"kill\" ) ) ) )\r\n        call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Gold|r: \" + I2S( udg_GoldAllTime[i] ) )\r\n        \r\n        if GetUnitTypeId(u) == 'N02P' then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Pyromagic|r: Extra damage: \" + I2S( R2I(PyrolordExtraDamage) ) )\r\n        endif    \r\n        if udg_Data[i + 92] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Now mine!|r: Gold: \" + I2S( udg_Data[i + 92] ) )\r\n        endif\r\n        if udg_Data[i + 96] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Goblin mood|r: Luck: \" + I2S( udg_Data[i + 96] ) )\r\n        endif\r\n        if udg_Data[i + 100] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Strengthening|r: Health: \" + I2S( udg_Data[i + 100] ) )\r\n        endif\r\n        if udg_Data[i + 104] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Seal of fate|r: Agility: \" + I2S( udg_Data[i + 104] ) )\r\n        endif\r\n        if udg_Data[i + 112] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Malice|r: Spell power: \" + R2SW( 0.15 * udg_Data[i + 112], 1, 2 ) + \"%\" )\r\n        endif\r\n        if udg_Data[i + 116] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Harnessing anger|r: Attack: \" + I2S( udg_Data[i + 116] ) )\r\n        endif\r\n        if udg_Data[i + 136] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Black mark|r: Gold: \" + I2S( udg_Data[i + 136] ) )\r\n        endif\r\n        if udg_Data[i] != 0 or inv( u, 'I08G' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Automatron 'Income'|r: Gold: \" + I2S( udg_Data[i] ) )\r\n        endif\r\n        if udg_Data[i + 4] != 0 or inv( u, 'I07K' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Frozen blood|r: Stats: \" + I2S( udg_Data[i + 4] ) )\r\n        endif\r\n        if udg_Data[i + 8] != 0 or inv( u, 'I027' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Sharpened|r: Attack: \" + I2S( udg_Data[i + 8] ) )\r\n        endif\r\n        if udg_Data[i + 12] != 0 or udg_Data[i + 16] != 0 or udg_Data[i + 20] != 0 or inv( u, 'I07B' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runestone Pan|r: Level: \" + I2S( udg_Data[i + 12] ) + \", Stats: \" + I2S( udg_Data[i + 16] ) + \", Gold: \" + I2S( udg_Data[i + 20] ) )\r\n        endif\r\n        if udg_Data[i + 24] != 0 or udg_Data[i + 28] != 0 or udg_Data[i + 32] != 0 or inv( u, 'I047' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Banner|r: Strength: \" + I2S( udg_Data[i + 24] ) + \", Agility: \" + I2S( udg_Data[i + 28] ) + \", Intelligence: \" + I2S( udg_Data[i + 32] ) )\r\n        endif\r\n        if udg_Data[i + 40] != 0 or inv( u, 'I02L' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Boom machine|r: Health: \" + I2S( udg_Data[i + 40] ) )\r\n        endif\r\n        if udg_Data[i + 56] != 0 or inv( u, 'I06L' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Toy train|r: Strength: \" + I2S( udg_Data[i + 56] ) )\r\n        endif\r\n        if udg_Data[i + 60] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Solar Eclipse|r: Intelligence: \" + I2S( udg_Data[i + 60] ) )\r\n        endif\r\n        if udg_Data[i + 64] != 0 or inv( u, 'I04R' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Tesseract|r: Spell power: \" + R2SW( 0.3 * udg_Data[i + 64], 1, 1 ) + \"%\" )\r\n        endif\r\n        if udg_Data[i + 68] != 0 or udg_Data[i + 72] != 0 or udg_Data[i + 76] != 0 or inv( u, 'I01L' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Slippers of Madness|r: Strength: \" + I2S( udg_Data[i + 68] ) + \", Agility: \" + I2S( udg_Data[i + 72] ) + \", Intelligence: \" + I2S( udg_Data[i + 76] ) )\r\n        endif\r\n        if udg_Data[i + 80] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Voodoo explosion|r: Luck: \" + I2S( udg_Data[i + 80] ) )\r\n        endif\r\n        if udg_Data[i + 180] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Bloody coin|r: Gold: \" + I2S( udg_Data[i + 180] ) )\r\n        endif\r\n        if udg_Data[i + 168] != 0 or udg_Data[i + 172] != 0 or udg_Data[i + 176] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Devour|r: Strength: \" + I2S( udg_Data[i + 168] ) + \", Agility: \" + I2S( udg_Data[i + 172] ) + \", Intelligence: \" + I2S( udg_Data[i + 176] ) )\r\n        endif\r\n        if inv( u, 'I09E' ) > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Bloody figurine|r: Strength: \" + I2S( udg_Data[i + 120] ) + \", Agility: \" + I2S( udg_Data[i + 124] ) + \", Intelligence: \" + I2S( udg_Data[i + 128] ) )\r\n        endif\r\n        if udg_Data[i + 192] != 0 or udg_Data[i + 196] != 0 or udg_Data[i + 200] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Snow boost|r: Strength: \" + I2S( udg_Data[i + 192] ) + \", Agility: \" + I2S( udg_Data[i + 196] ) + \", Intelligence: \" + I2S( udg_Data[i + 200] ) )\r\n        endif\r\n        if udg_Data[i + 204] > 0 or udg_Data[i + 208] > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Device|r: Agility: \" + I2S( udg_Data[i + 204] ) + \", Intellect: \" + I2S( udg_Data[i + 208] ) )\r\n        endif\r\n        if udg_Data[i + 212] > 0 or udg_Data[i + 216] > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Devouring flesh|r: Health: \" + I2S( udg_Data[i + 212] ) + \", Attack power: \" + I2S( udg_Data[i + 216] ) )\r\n        endif\r\n        if udg_Data[i + 220] != 0 or udg_Data[i + 224] != 0 or udg_Data[i + 228] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Crystal Barrage|r: Strength: \" + I2S( udg_Data[i + 220] ) + \", Agility: \" + I2S( udg_Data[i + 224] ) + \", Intelligence: \" + I2S( udg_Data[i + 228] ) )\r\n        endif\r\n        if udg_Data[i + 232] != 0 or udg_Data[i + 236] != 0 or udg_Data[i + 240] != 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Denial of the Past|r: Strength: \" + I2S( udg_Data[i + 232] ) + \", Agility: \" + I2S( udg_Data[i + 236] ) + \", Intelligence: \" + I2S( udg_Data[i + 240] ) )\r\n        endif\r\n        if udg_Data[i + 244] > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Mask of Dagoth Ur|r: Damage consumed: \" + I2S( udg_Data[i + 244] ) )\r\n        endif\r\n        if DamageAbsorbed_Value[i] > 0 then\r\n        \tcall DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Total damage absorbed|r: \" + I2S( DamageAbsorbed_Value[i] ) )\r\n        endif\r\n        \r\n        //Runesmith stats\r\n        if gold_gained > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Gold Gained|r: \" + I2S( R2I(gold_gained) ) )\r\n        endif\r\n        if hp_gained > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Hitpoints Gained|r: \" + I2S( R2I(hp_gained) ) )\r\n        endif\r\n        if hpr_gained > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Regen Gained|r: \" + R2SW(hpr_gained, 1, 1) )\r\n        endif\r\n        if ap_gained > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Attack Power Gained|r: \" + I2S( R2I(ap_gained) ) )\r\n        endif\r\n        if sp_gained > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Spell Power Gained|r: \" + R2SW(sp_gained, 1, 1) )\r\n        endif\r\n        if stats_gained > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Stats Gained|r: \" + I2S( R2I(stats_gained) ) )\r\n        endif\r\n        if gold_granted > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Gold Granted|r: \" + I2S( R2I(gold_granted) ) )\r\n        endif\r\n        if hp_granted > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Hitpoints Granted|r: \" + I2S( R2I(hp_granted) ) )\r\n        endif\r\n        if hpr_granted > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Regen Granted|r: \" + R2SW(hpr_granted, 1, 1) )\r\n        endif\r\n        if ap_granted  > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Attack Power Granted|r: \" + I2S( R2I(ap_granted ) ) )\r\n        endif\r\n        if sp_granted  > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Spell Power Granted|r: \" + R2SW(sp_granted , 1, 1) )\r\n        endif\r\n        if stats_granted > 0 then\r\n            call DisplayTimedTextToPlayer( p, 0, 0, 10, \"|cffffcc00Runesmith Stats Granted|r: \" + I2S( R2I(stats_granted ) ) )\r\n        endif\r\n        \r\n        set u = null\r\n        set p = null\r\n    endfunction\r\n    \r\n    // Удаление предметов\r\n\tfunction RemoveItems takes integer i returns nothing\r\n\t    local integer j\r\n\t    local integer cyclA = 0\r\n\t    local integer s\r\n\t\r\n\t    if GetLocalPlayer() == Player(i-1) then\r\n\t        call BlzFrameSetVisible( sklbk,false)\r\n\t        call BlzFrameSetVisible( refbk,false)\r\n\t        if udg_Heroes_Amount > 1 and udg_number[69 + i] > 0 then\r\n\t            call BlzFrameSetVisible( pvpbk,true)\r\n\t        endif\r\n\t    endif\r\n\t    \r\n\t    if inv(udg_hero[i], 'I0EU' ) > 0 and not(udg_ItemGetChoosed[i]) and udg_ItemGetActive[i] then\r\n\t        set s = LoadInteger( udg_hash, GetHandleId(udg_hero[i]), StringHash( udg_QuestItemCode[14] ) ) + 1\r\n\t        call SaveInteger( udg_hash, GetHandleId(udg_hero[i]), StringHash( udg_QuestItemCode[14] ), s )\r\n\t\r\n\t        if s >= udg_QuestNum[14] then\r\n\t            call SaveReal( udg_hash, GetHandleId(udg_hero[i]), StringHash( udg_QuestItemCode[14] ), 0 )\r\n\t            call SetWidgetLife( GetItemOfTypeFromUnitBJ(udg_hero[i], 'I0EU'), 0 )\r\n\t            set bj_lastCreatedItem = CreateItem( 'I0EV', GetUnitX(udg_hero[i]), GetUnitY(udg_hero[i]))\r\n\t            call UnitAddItem(udg_hero[i], bj_lastCreatedItem)\r\n\t            call textst( \"|c00ffffff Blacksmith craft done!\", udg_hero[i], 64, GetRandomReal( 45, 135 ), 12, 1.5 )\r\n\t            call DestroyEffect( AddSpecialEffect( \"Abilities\\\\Spells\\\\Human\\\\ReviveHuman\\\\ReviveHuman.mdl\", GetUnitX(udg_hero[i]), GetUnitY(udg_hero[i]) ) )\r\n\t            set udg_QuestDone[i] = true\r\n\t        else\r\n\t            call QuestDiscription( udg_hero[i], 'I0EU', s, udg_QuestNum[14] )\r\n\t        endif\r\n\t    endif\r\n\t    \r\n\t    call ItemRandomizerLib_RemoveRewards(Player(i-1))\r\n\t    //Не раньше квеста\r\n\t    set udg_ItemGetActive[i] = false\r\n\tendfunction\r\n\r\n    //Remove item\r\n    function click1 takes nothing returns nothing\r\n        if GetLocalPlayer() == GetTriggerPlayer() then\r\n            call BlzFrameSetVisible( sklbk,false)\r\n            call BlzFrameSetVisible( sklbk,true)\r\n        endif\r\n\r\n        call RemoveItems( GetPlayerId(GetTriggerPlayer()) + 1 )\r\n    endfunction\r\n\r\n    //Refresh item\r\n    /*function ItemsRefresh takes integer i returns nothing\r\n    \t\r\n        local integer cyclA\r\n        local integer j\r\n        \r\n        set cyclA = 0\r\n        loop\r\n            exitwhen cyclA > 2\r\n            set j = ( 3 * i ) - cyclA\r\n            call DestroyEffect( AddSpecialEffectLoc( \"Abilities\\\\Spells\\\\Human\\\\Polymorph\\\\PolyMorphDoneGround.mdl\", Location(GetItemX(udg_item[j]), GetItemY(udg_item[j]) ) ) )\r\n            call RemoveItem( udg_item[j] )\r\n            set udg_item[j] = null\r\n            set cyclA = cyclA + 1\r\n        endloop\r\n        set IsItemsRefreshed = true\r\n        if i == 1 then\r\n            call Randomizer(true,false,false,false)\r\n        elseif i == 2 then\r\n            call Randomizer(false,true,false,false)\r\n        elseif i == 3 then\r\n            call Randomizer(false,false,true,false)\r\n        elseif i == 4 then\r\n            call Randomizer(false,false,false,true)\r\n        endif\r\n        set IsItemsRefreshed = false\r\n    endfunction*/\r\n\r\n\t//Refresh Rewards\r\n    function click4 takes nothing returns nothing\r\n    \tlocal player playerUsed = GetTriggerPlayer()\r\n        local integer k = GetPlayerId(playerUsed) + 1\r\n\r\n        if GetPlayerState( playerUsed, PLAYER_STATE_RESOURCE_GOLD) >= 100 and udg_roll[k] > 0 then\r\n            set udg_roll[k] = udg_roll[k] - 1\r\n            if udg_roll[k] <= 0 then\r\n                if GetLocalPlayer() == playerUsed then\r\n                    call BlzFrameSetVisible( refbk,false)\r\n                endif\r\n            endif\r\n            //call ItemsRefresh(k)\r\n            call ItemRandomizerLib_RefreshItems(playerUsed)\r\n            \r\n            call SetPlayerState( playerUsed, PLAYER_STATE_RESOURCE_GOLD, IMaxBJ( 0, GetPlayerState( playerUsed, PLAYER_STATE_RESOURCE_GOLD) - 100 ) )\r\n        endif\r\n        \r\n        set playerUsed = null\r\n    endfunction\r\n\r\n    //Start fight\r\n    function click takes nothing returns nothing\r\n        local player p = GetTriggerPlayer()\r\n        local integer i = GetPlayerId(p) + 1\r\n        local string icon\r\n\r\n        if GetLocalPlayer() == p then\r\n            call BlzFrameSetVisible( butbk,false)\r\n            call BlzFrameSetVisible( butbk,true)\r\n            call BlzFrameSetVisible( arrowframe, false )\r\n        endif\r\n            \r\n        if not(udg_fightlogic[i]) then\r\n            call BlzFrameSetTexture( iconframe[i], \"ReplaceableTextures\\\\CommandButtons\\\\BTNDivineIntervention.blp\", 0, true )\r\n            set udg_fightlogic[i] = true\r\n            set udg_Player_Readiness = udg_Player_Readiness + 1\r\n            if GetLocalPlayer() == p then\r\n                call BlzFrameSetTexture(butbk, \"ReplaceableTextures\\\\CommandButtons\\\\BTNSteelMelee.blp\", 0, true)\r\n            endif\r\n            call RemoveItems( i )\r\n            if udg_Player_Readiness >= udg_Heroes_Amount then\r\n                call BlzFrameSetVisible( rpkmod,false)\r\n                call TriggerExecute( gg_trg_StartFight )\r\n            endif\r\n        else\r\n            call BlzFrameSetTexture( iconframe[i], \"ReplaceableTextures\\\\CommandButtons\\\\BTNDivineShieldOff.blp\", 0, true )\r\n            set udg_fightlogic[i] = false\r\n            set udg_Player_Readiness = udg_Player_Readiness - 1\r\n            if GetLocalPlayer() == p then\r\n                call BlzFrameSetTexture(butbk, \"ReplaceableTextures\\\\CommandButtons\\\\BTNArcaniteMelee.blp\", 0, true)\r\n            endif\r\n        endif\r\n        \r\n        set p = null\r\n    endfunction\r\n\r\n    //Repick\r\n    function buttonmod1 takes nothing returns nothing\r\n        call Repick( GetTriggerPlayer() )\r\n    endfunction\r\n\r\n    //Jule pick\r\n    /*function JulePick takes nothing returns nothing\r\n        local player p = GetTriggerPlayer()\r\n\r\n        if GetLocalPlayer() == p then\r\n            call BlzFrameSetVisible( juleIcon,false)\r\n            call BlzFrameSetVisible( juleIcon,true)\r\n        endif\r\n        \r\n        if not(IsUnitHiddenBJ(udg_UNIT_JULE)) then\r\n            call SelectUnitForPlayerSingle( udg_UNIT_JULE, p )\r\n        endif\r\n        \r\n        set p = null\r\n    endfunction*/\r\n\r\n    function Trig_BaseTooltip_Actions takes nothing returns nothing\r\n        local trigger trig\r\n        local framehandle h\r\n        local framehandle tooltip\r\n        local string text\r\n        local integer cyclA = 1\r\n        local real i\r\n\r\n        set fon = BlzCreateFrame(\"EscMenuBackdrop\", BlzGetOriginFrame(ORIGIN_FRAME_GAME_UI, 0), 0, 0)\r\n        call BlzFrameSetAbsPoint(fon, FRAMEPOINT_CENTER, 0.398, 0.16)\r\n        call BlzFrameSetSize(fon, 0.22, 0.075)\r\n        call BlzFrameSetLevel( fon, -1 )\r\n        \r\n        set readyParent = BlzCreateFrameByType(\"FRAME\", \"\", fon, \"StandartFrameTemplate\", 0)\r\n        \r\n        loop\r\n            exitwhen cyclA > 4\r\n            if cyclA < 3 then\r\n                set i = 0\r\n            else\r\n                set i = 0.06\r\n            endif\r\n            set iconframe[cyclA] = BlzCreateFrameByType(\"BACKDROP\", \"\", readyParent, \"StandartFrameTemplate\", 0)\r\n            call BlzFrameSetAbsPoint(iconframe[cyclA], FRAMEPOINT_CENTER, 0.22 + (0.06*cyclA) + i, 0.55)\t\r\n            call BlzFrameSetSize(iconframe[cyclA], 0.04, 0.04)\r\n            call BlzFrameSetVisible( iconframe[cyclA],false)\r\n            \r\n            if GetPlayerSlotState(Player(cyclA-1)) == PLAYER_SLOT_STATE_PLAYING then\r\n                call BlzFrameSetTexture( iconframe[cyclA], \"ReplaceableTextures\\\\CommandButtons\\\\BTNDivineShieldOff.blp\", 0, true )\r\n            \r\n                set faceframe[cyclA] = BlzCreateFrameByType(\"BACKDROP\", \"\", readyParent, \"StandartFrameTemplate\", 0)\r\n                call BlzFrameSetTexture( faceframe[cyclA], \"ReplaceableTextures\\\\CommandButtons\\\\BTNSelectHeroOn.blp\", 0, true )\r\n                call BlzFrameSetAbsPoint(faceframe[cyclA], FRAMEPOINT_CENTER, 0.22 + (0.06*cyclA) + i, 0.53)\r\n                call BlzFrameSetSize(faceframe[cyclA], 0.02, 0.02)\r\n                call BlzFrameSetLevel( faceframe[cyclA], 1 )\r\n                call BlzFrameSetVisible( faceframe[cyclA],false)\r\n            \r\n                set uniqframe[cyclA] = BlzCreateFrameByType(\"BACKDROP\", \"\", readyParent, \"StandartFrameTemplate\", 0)\r\n                call BlzFrameSetAbsPoint(uniqframe[cyclA], FRAMEPOINT_CENTER, 0.20 + (0.06*cyclA) + i, 0.53)\t\r\n                call BlzFrameSetSize(uniqframe[cyclA], 0.015, 0.015)\r\n                call BlzFrameSetLevel( uniqframe[cyclA], 1 )\r\n                call BlzFrameSetVisible( uniqframe[cyclA],false)\r\n\r\n                set specframe[cyclA] = BlzCreateFrameByType(\"BACKDROP\", \"\", readyParent, \"StandartFrameTemplate\", 0)\r\n                call BlzFrameSetAbsPoint(specframe[cyclA], FRAMEPOINT_CENTER, 0.24 + (0.06*cyclA) + i, 0.53)\t\r\n                call BlzFrameSetSize(specframe[cyclA], 0.015, 0.015)\r\n                call BlzFrameSetLevel( specframe[cyclA], 1 )\r\n                call BlzFrameSetVisible( specframe[cyclA],false)\r\n            else\r\n                call BlzFrameSetTexture( iconframe[cyclA], \"war3mapImported\\\\BTNDivineShieldOff-Reforged.blp\", 0, true )\r\n            endif\r\n            set cyclA = cyclA + 1\r\n        endloop\r\n        //Jule icon\r\n        /*set juleIcon = BlzCreateFrameByType(\"BACKDROP\", \"\", fon, \"StandartFrameTemplate\", 0)\r\n        call BlzFrameSetAbsPoint(juleIcon, FRAMEPOINT_CENTER, 0.4, 0.54)\t\r\n        call BlzFrameSetSize(juleIcon, 0.02, 0.02)\r\n        call BlzFrameSetVisible( juleIcon,false)\r\n        call BlzFrameSetTexture( juleIcon, \"ReplaceableTextures\\\\CommandButtons\\\\BTNDarkTroll.blp\", 0, true )\r\n            \r\n        set h = BlzCreateFrameByType(\"GLUEBUTTON\", \"\", juleIcon, \"ScoreScreenTabButtonTemplate\", 0)\r\n        call BlzFrameSetSize( h, 0.02, 0.02 )\r\n        call BlzFrameSetPoint(h, FRAMEPOINT_CENTER, juleIcon, FRAMEPOINT_CENTER, 0.0,0.0)\r\n        set trig = CreateTrigger()\r\n        call BlzTriggerRegisterFrameEvent(trig, h, FRAMEEVENT_CONTROL_CLICK)\r\n        call TriggerAddAction(trig, function JulePick)\r\n\r\n        call SetStableTool( h, \"Jule\", \"Opens a window from the Jule store.\" )*/\r\n\r\n        //Readiness button\r\n        set butbk = BlzCreateFrameByType(\"BACKDROP\", \"\", fon, \"StandartFrameTemplate\", 0)\r\n        call BlzFrameSetSize(butbk, 0.04, 0.04)\r\n        call BlzFrameSetTexture(butbk, \"ReplaceableTextures\\\\CommandButtons\\\\BTNArcaniteMelee.blp\", 0, true)\r\n        call BlzFrameSetLevel( butbk, -1 )\r\n        \r\n        set h = BlzCreateFrameByType(\"GLUEBUTTON\", \"\", butbk, \"ScoreScreenTabButtonTemplate\", 0)\r\n        call BlzFrameSetSize( h, 0.04, 0.04 )\r\n        call BlzFrameSetPoint( h, FRAMEPOINT_CENTER, fon, FRAMEPOINT_CENTER, 0.0, 0.0 )\r\n        call BlzFrameSetPoint(butbk, FRAMEPOINT_CENTER, h, FRAMEPOINT_CENTER, 0.0,0.0)\r\n        \r\n        set trig = CreateTrigger()\r\n        call BlzTriggerRegisterFrameEvent(trig, h, FRAMEEVENT_CONTROL_CLICK)\r\n        call TriggerAddAction(trig, function click)\r\n        \r\n        set text = \"You confirm your readiness. You will begin the battle when all players confirm their readiness.\\n\\n|cffffcc00If you do not select an artifact-reward, these artifacts will disappear.|r\"\r\n        call SetStableTool( h, \"Readiness\", text )\r\n\r\n        //Refuse button\r\n        set sklbk = BlzCreateFrameByType(\"BACKDROP\", \"\", fon, \"StandartFrameTemplate\", 0)\r\n        call BlzFrameSetSize(sklbk, 0.04, 0.04)\r\n        call BlzFrameSetTexture(sklbk, \"ReplaceableTextures\\\\CommandButtons\\\\BTNSacrificialSkull.blp\", 0, true)\r\n        call BlzFrameSetLevel( sklbk, -1 )\r\n        \r\n        set h = BlzCreateFrameByType(\"GLUEBUTTON\", \"\", sklbk, \"ScoreScreenTabButtonTemplate\", 0)\r\n        call BlzFrameSetSize( h, 0.04, 0.04 )\r\n        call BlzFrameSetPoint( h, FRAMEPOINT_CENTER, fon, FRAMEPOINT_CENTER, 0.05, 0.0 )\r\n        call BlzFrameSetPoint(sklbk, FRAMEPOINT_CENTER, h, FRAMEPOINT_CENTER, 0.0,0.0)\r\n        set trig = CreateTrigger()\r\n        call BlzTriggerRegisterFrameEvent(trig, h, FRAMEEVENT_CONTROL_CLICK)\r\n        call TriggerAddAction(trig, function click1)\r\n        \r\n        set text = \"You refuse artifacts in the room. You can’t pick them up, but you can use the exchanger and arenas at Cute Bob.\"\r\n        call SetStableTool( h, \"Refuse artifacts\", text )\r\n\r\n        //Data button\r\n        set scrbk = BlzCreateFrameByType(\"BACKDROP\", \"\", fon, \"StandartFrameTemplate\", 0)\r\n        call BlzFrameSetSize(scrbk, 0.04, 0.04)\r\n        call BlzFrameSetTexture(scrbk, \"ReplaceableTextures\\\\CommandButtons\\\\BTNBansheeMaster.blp\", 0, true)\r\n        call BlzFrameSetLevel( scrbk, -1 )\r\n\r\n        set h = BlzCreateFrameByType(\"GLUEBUTTON\", \"\", scrbk, \"ScoreScreenTabButtonTemplate\", 0)\r\n        call BlzFrameSetSize( h, 0.04, 0.04 )\r\n        call BlzFrameSetPoint( h, FRAMEPOINT_CENTER, fon, FRAMEPOINT_CENTER, -0.05, 0.0 )\r\n        call BlzFrameSetPoint(scrbk, FRAMEPOINT_CENTER, h, FRAMEPOINT_CENTER, 0.0,0.0)\r\n        set trig = CreateTrigger()\r\n        call BlzTriggerRegisterFrameEvent(trig, h, FRAMEEVENT_CONTROL_CLICK)\r\n        call TriggerAddAction(trig, function click2)\r\n        \r\n        set text = \"Shows changes in all data of the hero per match.\"\r\n        call SetStableTool( h, \"Data\", text )\r\n\r\n        //Duel button\r\n        set pvpbk = BlzCreateFrameByType(\"BACKDROP\", \"\", fon, \"StandartFrameTemplate\", 0)\r\n        call BlzFrameSetSize(pvpbk, 0.04, 0.04)\r\n        call BlzFrameSetTexture(pvpbk, \"ReplaceableTextures\\\\CommandButtons\\\\BTNMassTeleport.blp\", 0, true)\r\n        call BlzFrameSetLevel( pvpbk, -1 )\r\n\r\n        set h = BlzCreateFrameByType(\"GLUEBUTTON\", \"\", pvpbk, \"ScoreScreenTabButtonTemplate\", 0)\r\n        call BlzFrameSetSize( h, 0.04, 0.04 )\r\n        call BlzFrameSetPoint( h, FRAMEPOINT_CENTER, fon, FRAMEPOINT_CENTER, 0.05, 0.0 )\r\n        call BlzFrameSetPoint(pvpbk, FRAMEPOINT_CENTER, h, FRAMEPOINT_CENTER, 0.0,0.0)\r\n        set trig = CreateTrigger()\r\n        call BlzTriggerRegisterFrameEvent(trig, h, FRAMEEVENT_CONTROL_CLICK)\r\n        call TriggerAddAction(trig, function PvPButton)\r\n\r\n        set text = \"Your hero may fight with another player. The match ends when one of the heroes dies or time runs out. The duration of the battles is 120 seconds.\\n\\n|cffffcc00Tries give the end of the battle with the boss.|r\"\r\n        call SetStableTool( h, \"Duel\", text )\r\n        \r\n        //Change artifact button\r\n        set refbk = BlzCreateFrameByType(\"BACKDROP\", \"\", fon, \"StandartFrameTemplate\", 0)\r\n        call BlzFrameSetSize(refbk, 0.02, 0.02)\r\n        call BlzFrameSetTexture(refbk, \"war3mapImported\\\\BTNAchievement_BG_returnXflags_def_WSG.blp\", 0, true)\r\n        call BlzFrameSetLevel( refbk, -1 )\r\n        \r\n        set h = BlzCreateFrameByType(\"GLUEBUTTON\", \"\", refbk, \"ScoreScreenTabButtonTemplate\", 0)\r\n        call BlzFrameSetSize( h, 0.02, 0.02 )\r\n        call BlzFrameSetPoint( h, FRAMEPOINT_TOPRIGHT, fon, FRAMEPOINT_TOPRIGHT, -0.018, -0.018 )\r\n        call BlzFrameSetPoint(refbk, FRAMEPOINT_CENTER, h, FRAMEPOINT_CENTER, 0.0,0.0)\r\n        set trig = CreateTrigger()\r\n        call BlzTriggerRegisterFrameEvent(trig, h, FRAMEEVENT_CONTROL_CLICK)\r\n        call TriggerAddAction(trig, function click4)\r\n\r\n        set text = \"Changes reward artifacts to other artifacts one time per selection.\\n|cffffcc00Cost:|r 100 gold.\"\r\n        call SetStableTool( h, \"Change artifacts\", text )\r\n\r\n        //Hero reselection button\r\n        set rpkmod = BlzCreateFrameByType(\"BACKDROP\", \"\", BlzGetOriginFrame(ORIGIN_FRAME_GAME_UI, 0), \"StandartFrameTemplate\", 0)\r\n        call BlzFrameSetSize(rpkmod, 0.04, 0.04)\r\n        call BlzFrameSetTexture(rpkmod, \"ReplaceableTextures\\\\CommandButtons\\\\BTNDispelMagic.blp\", 0, true)\r\n        call BlzFrameSetLevel( rpkmod, -1 )\r\n        \r\n        set reselectionButton = BlzCreateFrameByType(\"GLUEBUTTON\", \"\", rpkmod, \"ScoreScreenTabButtonTemplate\", 0)\r\n        call BlzFrameSetSize( reselectionButton, 0.04, 0.04 )\r\n        call BlzFrameSetPoint( rpkmod, FRAMEPOINT_CENTER, fon, FRAMEPOINT_CENTER, -0.05, 0.0 )\r\n        call BlzFrameSetPoint(reselectionButton, FRAMEPOINT_CENTER, rpkmod, FRAMEPOINT_CENTER, 0.0,0.0)\r\n        \r\n        set trig = CreateTrigger()\r\n        call BlzTriggerRegisterFrameEvent(trig, reselectionButton, FRAMEEVENT_CONTROL_CLICK)\r\n        call TriggerAddAction(trig, function buttonmod1)\r\n        \r\n        call SetStableTool( reselectionButton, \"Re-selection\", \"Allows you to choose another hero.\" )\r\n        \r\n        call BlzFrameSetVisible( rpkmod,false )\r\n        call BlzFrameSetVisible( fon, false )\r\n        call BlzFrameSetVisible( sklbk, false )\r\n        call BlzFrameSetVisible( scrbk, false )\r\n        call BlzFrameSetVisible( pvpbk, false )\r\n        call BlzFrameSetVisible( refbk, false )\r\n\r\n        set trig = null\r\n        set tooltip = null\r\n        set h = null\r\n    endfunction\r\n    \r\n    //===========================================================================\r\n    private function EnableRolls takes nothing returns nothing\r\n    \tlocal integer index = Event_FightEnd_DelayUnit_Index\r\n    \tlocal player user = Event_FightEnd_DelayUnit_Player\r\n    \t\r\n    \tif udg_ItemGetActive[index] == false then\r\n  \t\t\treturn\r\n\t\telseif udg_roll[index] == 0 then\r\n\t\t\treturn\r\n\t\telseif ItemRandomizerLib_IsAnyRewardSelectedThisRound(user) then\r\n\t\t\treturn\r\n\t\tendif\r\n    \t\r\n    \tif GetLocalPlayer() == user then\r\n            call BlzFrameSetVisible( refbk, true)\r\n        endif\r\n        set user = null\r\n    endfunction\r\n    \r\n    private function EnableRefuseReward takes nothing returns nothing\r\n    \tlocal integer index = Event_FightEnd_DelayUnit_Index\r\n    \tlocal player user = Event_FightEnd_DelayUnit_Player\r\n    \t\r\n    \t//call BJDebugMsg(\"udg_ItemGetActive[index]: \" + B2S(udg_ItemGetActive[index]))\r\n    \t\r\n    \tif udg_ItemGetActive[index] then\r\n\t        if GetLocalPlayer() == user then\r\n\t            call BlzFrameSetVisible( sklbk, true )\r\n\t        endif\r\n\t    elseif udg_ItemGetActive[index] == false and udg_Heroes_Amount > 1 and udg_number[69 + index] > 0 then\r\n\t        if GetLocalPlayer() == user then\r\n\t            call BlzFrameSetVisible( pvpbk, true )\r\n\t        endif\r\n\t    endif\r\n\t    set user = null\r\n    endfunction\r\n    \r\n    private function OnMatchEnd takes nothing returns nothing\r\n    \tcall BlzFrameSetVisible( fon, true)\r\n    \tcall BlzFrameSetVisible( readyParent,false)\r\n  \t\r\n        call BlzFrameSetVisible( scrbk, true )\r\n        call BlzFrameSetVisible( sklbk, false )\r\n        call BlzFrameSetVisible( pvpbk, false )\r\n        call BlzFrameSetVisible( refbk, false )\r\n        call BlzFrameSetVisible( butbk, false )\r\n    endfunction\r\n    \r\n    //===========================================================================\r\n    private function init takes nothing returns nothing\r\n        call TimerStart( CreateTimer(), 0.1, false, function Trig_BaseTooltip_Actions )\r\n        \r\n        call CreateEventTrigger( \"Event_FightEnd_DelayUnit\", function EnableRolls, null )\r\n        call CreateEventTrigger( \"Event_FightEnd_DelayUnit\", function EnableRefuseReward, null )\r\n        \r\n        call CreateEventTrigger( \"Event_MatchEnd\", function OnMatchEnd, null )\r\n    endfunction\r\n\r\nendscope",
  "Events": [],
  "LocalVariables": [],
  "Conditions": [],
  "Actions": []
}